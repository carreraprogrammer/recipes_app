<div class="generalContainer">
  <div>
    <%= link_to "Back to recipes", recipes_path %>
  </div>

  <h1 class="pageTitle"> <%= capitalize_text(@recipe.name) %></h1>
  <div class="recipeShowGeneralInfo">
    <p class="preparationTime"><strong>Preparation Time: </strong> <%= @recipe.preparation_time_minutes %></p>
    <%= render 'shared/change_public', recipe: @recipe %>
    <p class="cookingTime"><strong>Cooking Time: </strong> <%= @recipe.cooking_time_minutes %></p>
    <p class="recipeDescription"><%= @recipe.description %></p>
    <button ><%= link_to "Generate Shopping List", shopping_list_path %></button>
    <button id="addIngredientButton">Add Ingredient</button>
  </div>
    <table class="ingredientsTable">
      <tr>
        <th> Food </th>
        <th> Quantity </th>
        <th> Value </th>
        <th> Actions </th>
      </tr>
      <% @recipe.recipe_foods.each do |ingredient| %>
        <tr>
          <td><%= ingredient.food.name %></td>
          <td><%= ingredient.quantity %> <%= ingredient.food.measurement_unit %>s</td>
          <td>$<%= ingredient.food.price  * ingredient.quantity %></td>
          <td>
            <a> Edit </a>
            <%= button_to "Remove", ingredient, method: :delete %>
          </td>
        </tr>
      <% end %>
      <tr class="ingredientForm"> <!-- Added class -->
        <%= form_with(model: RecipeFood.new(), url: recipe_foods_path, class: "ingredientForm") do |form| %>
              <%= form.hidden_field :recipe_id, value: @recipe.id %>
              <td>
                <%= form.select :food_id, options_for_select(@foods.map { |food| [food.name, food.id] }) %>
              </td>
              <td>
                <%= form.number_field :quantity, placeholder: "Quantity" %>
              </td>
              <td>Add ingredient here</td>
              <td><%= form.submit %></td>
        <% end %>
      </tr>
    </table>
</div>

<script>
  document.getElementById("addIngredientButton").addEventListener("click", function() {
    const ingredientForm = document.querySelector(".ingredientForm");
    const ingredientInput = document.querySelector("#getName");
    ingredientForm.style.display = ingredientForm.style.display === "table-row" ? "none" : "table-row";
  });
</script>
